@model Core.DTOs.Orders.AdminOrderDto
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = $"Order #{Model.OrderNumber}";
    ViewData["ActivePage"] = "orders";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";

    // Allow status update for most orders (except Cancelled and Refunded)
    bool canModify = Model.Status != "Cancelled" && Model.Status != "Refunded";

    // Only allow cancel for Pending and Processing
    bool canCancel = Model.Status == "Pending" || Model.Status == "Processing";

    // Show refund button for Shipped and Delivered
    bool canRefund = Model.Status == "Shipped" || Model.Status == "Delivered";
}

<div class="container-fluid px-2 px-md-4">
    <!-- Header -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4 gap-2">
        <div>
            <h1 class="mt-4 mb-1">
                <a href="/admin/orders" class="text-decoration-none me-2" style="color: #912356;">
                    <i class="fas fa-arrow-left"></i>
                </a>
                Order #@Model.OrderNumber
            </h1>
            <p class="text-muted mb-0 ms-4 ps-2">@Model.OrderDate.ToString("MMMM dd, yyyy 'at' hh:mm tt")</p>
        </div>
        <span class="badge @GetStatusBadgeClass(Model.Status) fs-6 px-3 py-2">
            @Model.Status
        </span>
    </div>

    <!-- Alerts -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success" style="margin-bottom: 20px; display: block;" id="successAlert">
            <i class="fas fa-check-circle me-2"></i><strong>Success!</strong> @TempData["SuccessMessage"]
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger" style="margin-bottom: 20px; display: block;" id="errorAlert">
            <i class="fas fa-exclamation-circle me-2"></i><strong>Error:</strong> @TempData["ErrorMessage"]
        </div>
    }

    <div class="row">
        <!-- Left Column -->
        <div class="col-lg-8">
            <!-- Customer Info -->
            <div class="card mb-4 shadow-sm" style="border-left: 4px solid #912356;">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0"><i class="fas fa-user me-2" style="color: #912356;"></i>Customer Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <div class="mb-3">
                                <small class="text-muted d-block">Name</small>
                                <strong>@Model.GuestName</strong>
                            </div>
                            <div>
                                <small class="text-muted d-block">Email</small>
                                <a href="mailto:@Model.GuestEmail">@Model.GuestEmail</a>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <small class="text-muted d-block">Phone</small>
                                <a href="tel:@Model.GuestPhone">@Model.GuestPhone</a>
                            </div>
                            @if (!string.IsNullOrEmpty(Model.DiscountCode))
                            {
                                <div>
                                    <small class="text-muted d-block">Discount</small>
                                    <span class="badge bg-success">@Model.DiscountCode</span>
                                    <span class="ms-1">-EGP @Model.DiscountAmount.ToString("N2")</span>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Order Items -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0"><i class="fas fa-boxes me-2" style="color: #912356;"></i>Order Items (@Model.Items.Count)</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Product</th>
                                    <th class="text-center">Color</th>
                                    <th class="text-end">Price</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-end">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Items)
                                {
                                    <tr>
                                        <td>
                                            <strong>@item.ProductName</strong>
                                        </td>
                                        <td class="text-center">
                                            @if (!string.IsNullOrEmpty(item.SelectedColor))
                                            {
                                                <span class="badge bg-light text-dark">@item.SelectedColor</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">-</span>
                                            }
                                        </td>
                                        <td class="text-end">
                                            EGP @item.UnitPrice.ToString("N2")
                                            @if (item.DiscountPercent.HasValue && item.DiscountPercent.Value > 0)
                                            {
                                                <small class="d-block text-success">@item.DiscountPercent.Value% off</small>
                                            }
                                        </td>
                                        <td class="text-center">@item.Quantity</td>
                                        <td class="text-end fw-bold">EGP @item.LineTotal.ToString("N2")</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Shipping Info -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0"><i class="fas fa-truck me-2" style="color: #912356;"></i>Shipping Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <small class="text-muted d-block">Address</small>
                                <strong>@Model.ShippingAddress</strong>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <small class="text-muted d-block">City</small>
                                    <strong>@Model.ShippingCity</strong>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted d-block">Shipping Cost</small>
                                    <strong style="color: #912356;">EGP @Model.ShippingCost.ToString("N2")</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mt-3 mt-md-0">
                            <div class="timeline">
                                <div class="timeline-item">
                                    <div class="timeline-marker bg-success"></div>
                                    <div class="timeline-content">
                                        <small class="fw-bold">Order Placed</small>
                                        <small class="d-block text-muted">@Model.OrderDate.ToString("MMM dd, HH:mm")</small>
                                    </div>
                                </div>
                                @if (Model.ShippedDate.HasValue && Model.Status != "Cancelled")
                                {
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-primary"></div>
                                        <div class="timeline-content">
                                            <small class="fw-bold">Shipped</small>
                                            <small class="d-block text-muted">@Model.ShippedDate.Value.ToString("MMM dd, HH:mm")</small>
                                        </div>
                                    </div>
                                }
                                @if (Model.DeliveredDate.HasValue && Model.Status != "Cancelled")
                                {
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-success"></div>
                                        <div class="timeline-content">
                                            <small class="fw-bold">Delivered</small>
                                            <small class="d-block text-muted">@Model.DeliveredDate.Value.ToString("MMM dd, HH:mm")</small>
                                        </div>
                                    </div>
                                }
                                @if (Model.Status == "Cancelled")
                                {
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-danger"></div>
                                        <div class="timeline-content">
                                            <small class="fw-bold text-danger">Cancelled</small>
                                            <small class="d-block text-muted">Order has been cancelled</small>
                                        </div>
                                    </div>
                                }
                                @if (Model.Status == "Refunded")
                                {
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-secondary"></div>
                                        <div class="timeline-content">
                                            <small class="fw-bold text-secondary">Refunded</small>
                                            <small class="d-block text-muted">Order has been refunded</small>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column -->
        <div class="col-lg-4">
            <!-- Order Summary -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0"><i class="fas fa-receipt me-2" style="color: #912356;"></i>Order Summary</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted">Subtotal</span>
                        <span>EGP @Model.Subtotal.ToString("N2")</span>
                    </div>
                    @if (Model.DiscountAmount > 0)
                    {
                        <div class="d-flex justify-content-between mb-2 text-success">
                            <span>Discount</span>
                            <span>-EGP @Model.DiscountAmount.ToString("N2")</span>
                        </div>
                    }
                    <div class="d-flex justify-content-between mb-3">
                        <span class="text-muted">Shipping</span>
                        <span>EGP @Model.ShippingCost.ToString("N2")</span>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between">
                        <strong class="fs-5">Total</strong>
                        <strong class="fs-5" style="color: #912356;">EGP @Model.TotalAmount.ToString("N2")</strong>
                    </div>

                    <div class="mt-3 p-3 bg-light rounded">
                        <div class="d-flex justify-content-between small mb-1">
                            <span>Payment Method:</span>
                            <strong>@Model.PaymentMethod</strong>
                        </div>
                        <div class="d-flex justify-content-between small">
                            <span>Payment Status:</span>
                            <span class="badge @GetPaymentStatusBadgeClass(Model.PaymentStatus)">@Model.PaymentStatus</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0"><i class="fas fa-bolt me-2" style="color: #912356;"></i>Quick Actions</h5>
                </div>
                <div class="card-body">
                    @if (canModify && !canRefund)
                    {
                        <!-- Pending, Processing, etc. -->
                        <form action="/admin/orders/update-status" method="post" class="mb-3" id="updateStatusForm">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="id" value="@Model.Id">

                            <div class="mb-3">
                                <label class="form-label fw-bold">Update Status</label>
                                <select name="Status" class="form-select" required id="statusSelect">
                                    <option value="">Select Status</option>
                                    @foreach (var status in ViewBag.Statuses as List<SelectListItem>)
                                    {
                                        // Exclude "Cancelled" from dropdown
                                        if (status.Value == "Cancelled")
                                        {
                                            continue;
                                        }

                                        if (status.Value == Model.Status)
                                        {
                                            <option value="@status.Value" selected>@status.Text (Current)</option>
                                        }
                                        else
                                        {
                                            <option value="@status.Value">@status.Text</option>
                                        }
                                    }
                                </select>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <label class="form-label small">Shipped Date</label>
                                    <input type="datetime-local" name="ShippedDate" class="form-control form-control-sm" id="shippedDate"
                                           value="@(Model.ShippedDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                                <div class="col-6">
                                    <label class="form-label small">Delivered Date</label>
                                    <input type="datetime-local" name="DeliveredDate" class="form-control form-control-sm" id="deliveredDate"
                                           value="@(Model.DeliveredDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100" style="background-color: #912356; border-color: #912356;">
                                <i class="fas fa-save me-1"></i> Update Status
                            </button>
                        </form>

                        @if (canCancel)
                        {
                            <hr>
                            <button type="button" class="btn btn-outline-danger w-100" id="cancelOrderBtn">
                                <i class="fas fa-times me-1"></i> Cancel Order
                            </button>
                        }
                    }
                    else if (Model.Status == "Shipped")
                    {
                        <!-- SHIPPED: Show only Delivered and Refunded -->
                        <form action="/admin/orders/update-status" method="post" class="mb-3" id="updateStatusFormShipped">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="id" value="@Model.Id">

                            <div class="mb-3">
                                <label class="form-label fw-bold">Update Status</label>
                                <select name="Status" class="form-select" required id="statusSelectShipped">
                                    <option value="">Select Status</option>
                                    <option value="Delivered">Delivered</option>
                                    @* <option value="Refunded">Refunded</option> *@
                                </select>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <label class="form-label small">Shipped Date</label>
                                    <input type="datetime-local" name="ShippedDate" class="form-control form-control-sm" id="shippedDateShipped"
                                           value="@(Model.ShippedDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                                <div class="col-6">
                                    <label class="form-label small">Delivered Date</label>
                                    <input type="datetime-local" name="DeliveredDate" class="form-control form-control-sm" id="deliveredDateShipped"
                                           value="@(Model.DeliveredDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100" style="background-color: #912356; border-color: #912356;">
                                <i class="fas fa-save me-1"></i> Update Status
                            </button>
                        </form>

                        <hr>
                        <button type="button" class="btn btn-warning w-100" id="refundOrderBtnShipped">
                            <i class="fas fa-undo me-1"></i> Refund Order & Return Stock
                        </button>
                    }
                    else if (Model.Status == "Delivered")
                    {
                        <!-- DELIVERED: Show only Refunded -->
                        <form action="/admin/orders/update-status" method="post" class="mb-3" id="updateStatusFormDelivered">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="id" value="@Model.Id">

                            @* <div class="mb-3">
                                <label class="form-label fw-bold">Update Status</label>
                                <select name="Status" class="form-select" required id="statusSelectDelivered">
                                    <option value="">Select Status</option>
                                    <option value="Refunded">Refunded</option>
                                </select>
                            </div> *@

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <label class="form-label small">Shipped Date</label>
                                    <input type="datetime-local" name="ShippedDate" class="form-control form-control-sm" id="shippedDateDelivered"
                                           value="@(Model.ShippedDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                                <div class="col-6">
                                    <label class="form-label small">Delivered Date</label>
                                    <input type="datetime-local" name="DeliveredDate" class="form-control form-control-sm" id="deliveredDateDelivered"
                                           value="@(Model.DeliveredDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                </div>
                            </div>

                            @* <button type="submit" class="btn btn-primary w-100" style="background-color: #912356; border-color: #912356;">
                                <i class="fas fa-save me-1"></i> Update Status
                            </button> *@
                        </form>

                        <hr>
                        <button type="button" class="btn btn-warning w-100" id="refundOrderBtnDelivered">
                            <i class="fas fa-undo me-1"></i> Refund Order & Return Stock
                        </button>
                    }
                    else
                    {
                        <div class="p-3 bg-light border rounded text-center">
                            <i class="fas fa-lock me-2 text-muted"></i>
                            <span class="text-muted">This order is <strong>@Model.Status</strong> and cannot be modified.</span>
                        </div>
                    }
                </div>
            </div>

            <!-- Notes -->
            @if (!string.IsNullOrEmpty(Model.Notes))
            {
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="mb-0"><i class="fas fa-sticky-note me-2" style="color: #912356;"></i>Notes</h5>
                    </div>
                    <div class="card-body">
                        <pre style="white-space: pre-wrap; font-family: inherit; margin: 0; font-size: 0.9rem;">@Model.Notes</pre>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<!-- Cancel Order Modal -->
<div class="modal fade" id="cancelOrderModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i>Cancel Order</h5>
            </div>
            <form action="/admin/orders/cancel" method="post" id="cancelForm">
                @Html.AntiForgeryToken()
                <input type="hidden" name="id" value="@Model.Id">
                <div class="modal-body">
                    <div class="alert alert-warning mb-3" style="display: block;">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Warning:</strong> This action cannot be undone. Stock will be restored and the customer will be notified.
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Order: #@Model.OrderNumber</label>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Cancellation Reason <span class="text-danger">*</span></label>
                        <textarea name="reason" class="form-control" rows="4" placeholder="Please provide a reason..." required id="cancelReason"></textarea>
                        <small class="text-muted">This will be shared with the customer.</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="goBackBtn">
                        <i class="fas fa-arrow-left me-1"></i> Go Back
                    </button>
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-times me-1"></i> Confirm Cancellation
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Refund Order Modal -->
<div class="modal fade" id="refundOrderModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title"><i class="fas fa-undo me-2"></i>Refund Order</h5>
            </div>
            <form action="/admin/orders/refund" method="post" id="refundForm">
                @Html.AntiForgeryToken()
                <input type="hidden" name="id" value="@Model.Id">
                <div class="modal-body">
                    <div class="alert alert-warning mb-3" style="display: block;">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Warning:</strong> This will mark the order as Refunded and return all items to stock. This action cannot be undone.
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Order: #@Model.OrderNumber</label>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Refund Reason <span class="text-danger">*</span></label>
                        <textarea name="reason" class="form-control" rows="4" placeholder="Please provide a reason for the refund..." required id="refundReason"></textarea>
                        <small class="text-muted">This will be shared with the customer.</small>
                    </div>
                    <div class="alert alert-info">
                        <strong>Refund Amount:</strong> EGP @Model.TotalAmount.ToString("N2")
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="goBackRefundBtn">
                        <i class="fas fa-arrow-left me-1"></i> Go Back
                    </button>
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-undo me-1"></i> Confirm Refund
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    .modal-backdrop {
        opacity: 0.5 !important;
    }
</style>

@section Styles {
    <style>
        .timeline {
            position: relative;
            padding-left: 20px;
        }

        .timeline-item {
            position: relative;
            padding-bottom: 15px;
            padding-left: 15px;
        }

            .timeline-item:not(:last-child)::before {
                content: '';
                position: absolute;
                left: 5px;
                top: 14px;
                height: calc(100% - 4px);
                width: 2px;
                background: #dee2e6;
            }

        .timeline-marker {
            position: absolute;
            left: 0;
            top: 4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .card {
            border-radius: 12px;
            border: none;
        }

        .form-control:focus, .form-select:focus {
            border-color: #912356;
            box-shadow: 0 0 0 0.2rem rgba(145, 35, 86, 0.15);
        }

        .alert-warning {
            border-left: 4px solid #ffc107;
        }
    </style>
}

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ==================== CANCEL ORDER MODAL ====================
            const cancelModal = document.getElementById('cancelOrderModal');
            const cancelModalInstance = new bootstrap.Modal(cancelModal);
            const goBackBtn = document.getElementById('goBackBtn');
            const cancelForm = document.getElementById('cancelForm');
            const cancelOrderBtn = document.getElementById('cancelOrderBtn');

            if (cancelOrderBtn) {
                cancelOrderBtn.addEventListener('click', function() {
                    document.getElementById('cancelReason').value = '';
                    cancelModalInstance.show();
                });
            }

            if (goBackBtn) {
                goBackBtn.addEventListener('click', function() {
                    cancelModalInstance.hide();
                });
            }

            if (cancelForm) {
                cancelForm.addEventListener('submit', function(e) {
                    const reason = document.getElementById('cancelReason').value.trim();
                    if (!reason) {
                        e.preventDefault();
                        alert('Please provide a cancellation reason.');
                        return;
                    }
                    if (!confirm('Are you sure you want to cancel this order? This action cannot be undone.')) {
                        e.preventDefault();
                    }
                });
            }

            // ==================== REFUND ORDER MODAL ====================
            const refundModal = document.getElementById('refundOrderModal');
            const refundModalInstance = new bootstrap.Modal(refundModal);
            const goBackRefundBtn = document.getElementById('goBackRefundBtn');
            const refundForm = document.getElementById('refundForm');

            // Multiple refund buttons for different statuses
            const refundOrderBtnShipped = document.getElementById('refundOrderBtnShipped');
            const refundOrderBtnDelivered = document.getElementById('refundOrderBtnDelivered');

            function attachRefundListener(btn) {
                if (btn) {
                    btn.addEventListener('click', function() {
                        document.getElementById('refundReason').value = '';
                        refundModalInstance.show();
                    });
                }
            }

            attachRefundListener(refundOrderBtnShipped);
            attachRefundListener(refundOrderBtnDelivered);

            if (goBackRefundBtn) {
                goBackRefundBtn.addEventListener('click', function() {
                    refundModalInstance.hide();
                });
            }

            if (refundForm) {
                refundForm.addEventListener('submit', function(e) {
                    const reason = document.getElementById('refundReason').value.trim();
                    if (!reason) {
                        e.preventDefault();
                        alert('Please provide a refund reason.');
                        return;
                    }
                    if (!confirm('Are you sure you want to refund this order? This action cannot be undone.')) {
                        e.preventDefault();
                    }
                });
            }

            // ==================== AUTO-FILL DATES ====================
            function setupAutoFill(selectElement, shippedId, deliveredId) {
                if (selectElement) {
                    selectElement.addEventListener('change', function() {
                        const status = this.value;
                        const now = new Date();
                        const offset = now.getTimezoneOffset() * 60000;
                        const localISOTime = (new Date(now - offset)).toISOString().slice(0, 16);

                        if (status === 'Shipped') {
                            const shippedInput = document.getElementById(shippedId);
                            if (shippedInput && !shippedInput.value) {
                                shippedInput.value = localISOTime;
                            }
                        } else if (status === 'Delivered') {
                            const deliveredInput = document.getElementById(deliveredId);
                            const shippedInput = document.getElementById(shippedId);
                            if (deliveredInput && !deliveredInput.value) {
                                deliveredInput.value = localISOTime;
                            }
                            if (shippedInput && !shippedInput.value) {
                                shippedInput.value = localISOTime;
                            }
                        }
                    });
                }
            }

            setupAutoFill(document.getElementById('statusSelect'), 'shippedDate', 'deliveredDate');
            setupAutoFill(document.getElementById('statusSelectShipped'), 'shippedDateShipped', 'deliveredDateShipped');
            setupAutoFill(document.getElementById('statusSelectDelivered'), 'shippedDateDelivered', 'deliveredDateDelivered');
        });
    </script>
}

@functions {
    private string GetStatusBadgeClass(string status)
    {
        return status switch
        {
            "Pending" => "bg-warning text-dark",
            "Processing" => "bg-info",
            "Shipped" => "bg-primary",
            "Delivered" => "bg-success",
            "Cancelled" => "bg-danger",
            "Refunded" => "bg-secondary",
            _ => "bg-secondary"
        };
    }

    private string GetPaymentStatusBadgeClass(string status)
    {
        return status switch
        {
            "Succeeded" => "bg-success",
            "Pending" => "bg-warning text-dark",
            "Failed" => "bg-danger",
            "Cancelled" => "bg-secondary",
            "Refunded" => "bg-info",
            _ => "bg-secondary"
        };
    }
}