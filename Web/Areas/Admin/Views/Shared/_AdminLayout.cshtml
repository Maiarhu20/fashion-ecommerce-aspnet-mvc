@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using Microsoft.AspNetCore.Identity
@using Domain.Models
@inject UserManager<User> UserManager

@* @{
    var user = await UserManager.GetUserAsync(User);
    var displayName = user?.Name ?? User.Identity?.Name ?? "Admin";
} *@
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- In _AdminLayout.cshtml (or the layout that wraps this view) -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewData["Title"] - Admin </title>

    <!-- Favicon -->
    <link rel="icon" href="~/img/favicon.ico" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet" />

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <!-- Owl Carousel CSS -->
    <link href="~/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Template style -->
    <link href="~/css/style.css" rel="stylesheet" />

    @RenderSection("Styles", required: false)
</head>

<body>

    <!-- Topbar -->
    <div class="container-fluid">
        <!-- Social Media Bar -->
        <div class="row py-2 px-xl-5" style="background-color: #912356;">
            <div class="col-12 text-center">
                <div class="d-inline-flex align-items-center justify-content-center w-100">
                    <a class="text-light px-3" href="" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a class="text-light px-3" href="" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a class="text-light px-3" href="" aria-label="TikTok"><i class="fa-brands fa-tiktok"></i></a>
                </div>
            </div>
        </div>

        <!-- Search + Logo + Admin row -->
        <div class="row align-items-center py-3 px-xl-5">

            <!--  SEARCH – DESKTOP ONLY -->
            @* <div class="col-lg-3 col-4  d-none d-lg-block">
                <form class="topbar-search" >
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search…">
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-search"></i></span>
                        </div>
                    </div>
                </form>
            </div> *@

            <!--  LOGO  -->
            <div class="col-lg-6 col-4 text-center">
                <a class="text-decoration-none" asp-area="Admin" asp-controller="Dashboard" asp-action="Index">
                    <img src="" alt="" style="height: 120px; width: auto;" />
                </a>
            </div>

            <!--  ADMIN DROPDOWN + HAMBURGER  -->
            <div class="col-lg-3 col-8 d-flex justify-content-end align-items-center">

                <!-- Admin dropdown -->
                <div class="dropdown mr-2">
                    <button class="btn border topbar-cart dropdown-toggle text-truncate"
                            type="button" id="adminDropdown"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                            style="max-width: 28vw; white-space: nowrap; overflow: hidden;">
                        <i class="fas fa-user-cog"></i>
                        <span id="adminName" class="d-none d-sm-inline">
                            @{
                                var user = await UserManager.GetUserAsync(User);
                                var displayName = user?.Name ?? User.Identity?.Name ?? "Admin";
                                @displayName
                            }
                        </span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="adminDropdown">
                        <a class="dropdown-item" asp-area="Admin" asp-controller="Dashboard" asp-action="Index">
                            <i class="fas fa-tachometer-alt mr-2"></i> Dashboard
                        </a>
                        <a class="dropdown-item" asp-area="Admin" asp-controller="Auth" asp-action="ChangePassword">
                            <i class="fas fa-key mr-2"></i> Change Password
                        </a>
                        <div class="dropdown-divider"></div>
                        <form asp-area="Admin" asp-controller="Auth" asp-action="Logout"
                              method="post" id="logoutForm">
                            @Html.AntiForgeryToken()
                            <button type="submit"
                                    class="dropdown-item text-danger font-weight-bold"
                                    style="cursor:pointer;background:none;border:none;width:100%;text-align:left;">
                                <i class="fas fa-sign-out-alt mr-2"></i> Logout
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Hamburger -->
                <button class="btn btn-outline-pink d-lg-none mobile-menu-toggle"
                        type="button" data-toggle="collapse" data-target="#navbarCollapse"
                        aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="mobile-menu-icon"></span>
                </button>
            </div>
        </div>
        <!-- /Search + Logo + Admin row -->
        <!--  SEARCH – MOBILE (inside collapse)  -->
        <nav class="navbar navbar-expand-lg bg-light navbar-light py-0 px-0 d-lg-none">
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <!-- search box first in the collapse -->
                @* <form class="topbar-search px-3 pt-2 pb-3">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search…">
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-search"></i></span>
                        </div>
                    </div>
                </form> *@

                <!-- rest of mobile nav … -->
                @* <div class="navbar-nav w-100">
                    …existing mobile menu items…
                </div> *@
            </div>
        </nav>
    </div>

    <!-- Navbar Row -->
    <div class="container-fluid mb-5">
        <div class="row border-top px-xl-5">
            <!-- Desktop Sidebar -->
            <div class="col-lg-3 d-none d-lg-block">
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Categories" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-th-large"></i>
                        <span>Categories</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Products" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-box-open"></i>
                        <span>Products</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="HomeMedia" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-photo-video"></i>
                        <span>Images & Videos</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Discount" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-percent"></i>
                        <span>Discount Codes</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Shipping" asp-action="ManageCities" class="text-white text-decoration-none">
                        <i class="fas fa-shipping-fast"></i>
                        <span>Shipping Cities</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Orders" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Orders</span>
                    </a>
                </div>
                <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="height: 65px; margin-top: -1px; padding: 0 30px; border: 2px solid white;">
                    <a asp-area="Admin" asp-controller="Reviews" asp-action="Index" class="text-white text-decoration-none">
                        <i class="fas fa-star-half-alt"></i>
                        <span>Reviews</span>
                    </a>
                </div>
            </div>

            <!-- col-lg-9 with Mobile Nav + Content -->
            <div class="col-lg-9">
                <!-- Mobile Nav -->
                <nav class="navbar navbar-expand-lg bg-light navbar-light py-0 px-0">
                    <div class="collapse navbar-collapse" id="navbarCollapse">
                        <div class="navbar-nav w-100 d-lg-none">
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <span>Dashboard</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Categories" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-th-large"></i>
                                    <span>Categories</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Products" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-box-open"></i>
                                    <span>Products</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="HomeMedia" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-photo-video"></i>
                                    <span>Images & Videos</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Discount" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-percent"></i>
                                    <span>Discount Codes</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Shipping" asp-action="ManageCities" class="text-white text-decoration-none">
                                    <i class="fas fa-shipping-fast"></i>
                                    <span>Shipping Cities</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Orders" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>Orders</span>
                                </a>
                            </div>
                            <div class="btn shadow-none d-flex align-items-center justify-content-between bg-products text-white w-100" style="border: 2px solid white;">
                                <a asp-area="Admin" asp-controller="Reviews" asp-action="Index" class="text-white text-decoration-none">
                                    <i class="fas fa-star-half-alt"></i>
                                    <span>Reviews</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </nav>

                <!-- Success/Error Messages -->
                @if (TempData["SuccessMessage"] != null)
                {
                    <div class="alert alert-success alert-dismissible fade show mt-3" role="alert">
                        @TempData["SuccessMessage"]
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                }

                @if (TempData["ErrorMessage"] != null)
                {
                    <div class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
                        @TempData["ErrorMessage"]
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                }

                <!-- Content -->
                <main class="p-3">
                    @RenderBody()
                </main>
            </div>
        </div>
    </div>

    <partial name="_AdminFooter" />

    <!-- Core JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <!-- In your _AdminLayout.cshtml -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

    <!-- Local libraries -->
    <script src="~/lib/easing/easing.js"></script>
    <script src="~/lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template main JS -->
    <script src="~/js/main.js"></script>

    <!-- Custom Admin Scripts -->
    <script>
        // Auto-dismiss alerts after 5 seconds
        $(document).ready(function() {
            // Auto-hide alerts
            setTimeout(function() {
                $('.alert').alert('close');
            }, 5000);

            // Confirm logout
            $('#logoutForm').on('submit', function(e) {
                if (!confirm('Are you sure you want to logout?')) {
                    e.preventDefault();
                }
            });

            // Mobile menu toggle enhancement
            $('.mobile-menu-toggle').on('click', function() {
                $(this).toggleClass('active');
            });
        });
    </script>

    @RenderSection("Scripts", required: false)

</body>
</html>